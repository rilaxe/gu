import{$a as E,B as x,G as m,Za as R,fb as F,gb as M,hb as B,ib as A,kb as Y,lb as W,mb as L,rb as z}from"./chunk-CJ262RDI.js";import{h as N,q as T}from"./chunk-2YZJNNV5.js";Y();var f=N(W()),g=N(M());var rt=(()=>{let a=class a{constructor(e,t,i,s,n,h){this.router=e,this.auth=t,this.activeRoute=i,this.sch=s,this.gen=n,this.resultService=h,this.userName="",this.userImgPath="",this.mobileModal=!1,this.resultlist=[],this.gradeScalelist=[],this.psycomotorlist=[],this.psycomotorlist2=[],this.grademinimumlist=[],this.grademinimumlistOver60=[],this.grademinimumlistOver40=[],this.mySchoolClasses=[],this.gradescaletextlist=[],this.logoLoaded=!1,this.subjectOffered=0,this.markObtainable=0,this.displayValue="hidden",this.chartAverageScore=[],this.chartLowestScore=[],this.chartHighestScore=[],this.chartTotalScore=[],this.chartSubjects=[],this.genk=n,this.userName=t.currentUserValue.name,this.userImgPath=t.currentUserValue.logo,this.adminStatus=t.currentUserValue.status}createResult(e,t,i,s,n,h,d,c){this.genk.topdata="Dashboard",this.studentId=e,this.currentTerm=t,this.currentSessionId=i,this.currentSession=s,this.currentClassId=n,this.average=h,this.position=c,this.classAverage=d,this.getStudent(),this.getStudentTotal(),this.getClassNames(),this.getFormTeacher(),this.getResultsByStudent(),this.getCaSetupByClass(),this.getGradeScaleByClass(),this.getPsycomotorByStudent(),this.getStudentResultComment(),this.getStudentBMI(),this.getStudentEstimatedAttendance(),this.getStudentHouse(),this.getNextTerm()}loadPdfChart(e,t,i,s,n,h,d,c,I){this.genk.topdata="Dashboard",this.studentId=e,this.currentTerm=t,this.currentSessionId=i,this.currentSession=s,this.currentClassId=n,this.average=h,this.classAverage=d,this.mychart=c,this.mychartdiv=I,this.getStudent(),this.getStudentTotal(),this.getClassNames(),this.getCaSetupByClass(),this.getGradeScaleByClass(),this.getStudentResultComment()}setImg(e){return e&&e.length>0?this.genk.imgurl+e:this.genk.defaultImg}getSchool(){this.sch.getSchoolData().subscribe(e=>{this.myschool=e,g.default.fire({title:"Downloading Result...",allowEscapeKey:!1,allowOutsideClick:!1,didOpen:()=>T(this,null,function*(){g.default.showLoading();debugger;yield this.addLogo(),yield this.addSignature();let t=setInterval(()=>{clearInterval(t),clearTimeout(i),this.convertToPDF(),g.default.close()},500),i=setTimeout(()=>{clearInterval(t),g.default.close(),g.default.fire({icon:"error",title:"Failed to download result!",showConfirmButton:!1,timer:2e3})},24e4)})})})}getClassNames(){this.sch.getClassNames().subscribe(e=>{this.mySchoolClasses=e,this.getNoInClass()})}getStudent(){this.sch.getStudentAndCatById(this.studentId.toString()).subscribe(e=>T(this,null,function*(){this.studentobj=e.student;let t=e.category;t=="SENIOR"||t=="JUNIOR"?this.studentCat="STUDENT":this.studentCat="PUPIL"}))}getFormTeacher(){this.sch.getFormTeacher(this.currentClassId).subscribe(e=>{e?.name?this.formTeach=e?.name:this.formTeach=""})}getStudentTotal(){this.sch.getStudentTermTotal(this.currentSessionId.toString(),this.currentTerm,this.studentId).subscribe(e=>{this.studentTotal=e.total})}getNoInClass(){this.sch.getNoInClassBySession(this.currentClassId.toString(),this.currentSessionId,this.currentTerm).subscribe(e=>{this.noInClass=e.count,this.className=this.mySchoolClasses.filter(t=>t.id==Number(this.currentClassId))[0].class})}getNextTerm(){this.sch.getNextTerm(this.currentSessionId.toString(),this.currentTerm).subscribe(e=>{e&&(this.nextResumptionDate=e.date)})}getResultsByStudent(){g.default.fire({title:"Loading Result....",allowEscapeKey:!1,allowOutsideClick:!1,didOpen:()=>{g.default.showLoading(),this.sch.getResultsByStudent(this.currentClassId,this.currentSessionId.toString(),this.currentTerm,this.studentId).subscribe(e=>{this.resultlist=e,this.subjectOffered=this.resultlist.length,this.markObtainable=this.resultlist.length*100;let i=this.resultlist.map(s=>s.average).reduce((s,n)=>s+n,0);g.default.close(),this.getSchool()})}})}getStudentResultComment(){this.sch.getStudentResultComment(this.currentClassId,this.currentSessionId.toString(),this.currentTerm,this.studentId).subscribe(e=>{this.resultComment=e})}getCaSetupByClass(){this.sch.getCaSetupByClass(this.currentClassId,this.currentSessionId,this.currentTerm).subscribe(e=>{this.caSetupData=e.systemname,this.caSetupScoreData=e.score})}getStudentBMI(){this.sch.getStudentBMI(this.currentSessionId.toString(),this.currentTerm,this.studentId).subscribe(e=>{this.bmi=e,console.log(this.bmi)})}getStudentEstimatedAttendance(){this.sch.getStudentEstimatedAttendance(this.currentSessionId.toString(),this.currentTerm,this.studentId).subscribe(e=>{this.estAttendance=e,console.log(this.bmi)})}getStudentHouse(){this.sch.getUnitStudentHouse(this.studentId,this.currentSessionId.toString(),this.currentTerm).subscribe(e=>{debugger;this.house=e.house,console.log(this.house)})}getGradeScaleByClass(){this.sch.getGradeScaleByClass(this.currentClassId).subscribe(e=>{this.gradeScalelist=e,this.gradeScalelist.forEach(t=>{t.color=this.gradeColor(t.grade)}),this.grademinimumlist.push({color:"Black",remark:this.gradeScalelist.filter(t=>t.color=="Black")[this.gradeScalelist.filter(t=>t.color=="Black").length-1].remarks,minscore:this.gradeScalelist.filter(t=>t.color=="Black")[this.gradeScalelist.filter(t=>t.color=="Black").length-1].begLimit}),this.grademinimumlist.push({color:"Green",remark:this.gradeScalelist.filter(t=>t.color=="Green")[this.gradeScalelist.filter(t=>t.color=="Green").length-1].remarks,minscore:this.gradeScalelist.filter(t=>t.color=="Green")[this.gradeScalelist.filter(t=>t.color=="Green").length-1].begLimit}),this.grademinimumlist.push({color:"Blue",remark:this.gradeScalelist.filter(t=>t.color=="Blue")[this.gradeScalelist.filter(t=>t.color=="Blue").length-1].remarks,minscore:this.gradeScalelist.filter(t=>t.color=="Blue")[this.gradeScalelist.filter(t=>t.color=="Blue").length-1].begLimit}),this.grademinimumlist.push({color:"Red",remark:this.gradeScalelist.filter(t=>t.color=="Red")[this.gradeScalelist.filter(t=>t.color=="Red").length-1].remarks,minscore:this.gradeScalelist.filter(t=>t.color=="Red")[this.gradeScalelist.filter(t=>t.color=="Red").length-1].begLimit}),this.grademinimumlistOver60.push({color:"Green",minscore:this.over60Num(this.gradeScalelist.filter(t=>t.color=="Green")[this.gradeScalelist.filter(t=>t.color=="Green").length-1].begLimit)}),this.grademinimumlistOver60.push({color:"Black",minscore:this.over60Num(this.gradeScalelist.filter(t=>t.color=="Black")[this.gradeScalelist.filter(t=>t.color=="Black").length-1].begLimit)}),this.grademinimumlistOver60.push({color:"Blue",minscore:this.over60Num(this.gradeScalelist.filter(t=>t.color=="Blue")[this.gradeScalelist.filter(t=>t.color=="Blue").length-1].begLimit)}),this.grademinimumlistOver60.push({color:"Red",minscore:this.over60Num(this.gradeScalelist.filter(t=>t.color=="Red")[this.gradeScalelist.filter(t=>t.color=="Red").length-1].begLimit)}),console.log(this.grademinimumlist)})}gradeColor(e){return e.includes("A")||e.includes("B2")?"Black":e.includes("B3")||e.includes("C4")?"Green":e.includes("C5")||e.includes("C6")?"Blue":e.includes("D")||e.includes("E")||e.includes("F")?"Red":"Black"}getPsycomotorByStudent(){this.sch.getPsycomotorByStudent(this.currentSessionId.toString(),this.currentTerm,this.studentId).subscribe(e=>{e.length>0?this.psycomotorlist=e:this.sch.getSkillList().subscribe(t=>{this.psycomotorlist=t})})}convertToPDF(){var e=new A("p","pt","letter"),t=e.internal.pageSize.height||e.internal.pageSize.getHeight(),i=e.internal.pageSize.width||e.internal.pageSize.getWidth();e.setFont("Ariel","normal","900"),e.setTextColor("rgb(36, 91, 143)"),e.setFontSize(28),e.text(this.myschool?.schoolName??"",i/2,40,{align:"center"}),this.genk.logoString&&e.addImage(this.genk.logoString,"PNG",80,15,50,50),this.genk.signatureString&&e.addImage(this.genk.signatureString,"PNG",495,708,70,55),e.setFontSize(8),e.setTextColor("rgb(0, 0, 0)"),e.setFont("Ariel","italic"),e.text("Motto: Home of the Leadership Titans",i/2,55,{align:"center"}),e.setFontSize(8),e.setTextColor("rgb(0, 0, 0)"),e.setFont("","","500"),e.text(this.myschool?.address,i/2,65,{align:"center"}),e.setFont("","","600"),e.text("Tel: "+this.myschool?.phoneOne,i/2,75,{align:"center"}),e.setFontSize(13),e.setFont("","","800"),e.text("REPORT SHEET",i/2,94,{align:"center"}),e.setFontSize(8),e.setFont("","","600"),e.setFontSize(9),e.text("ACADEMIC RECORD",20,172);debugger;(0,f.default)(e,{body:[[`TERM: ${this.currentTerm}`,`SESSION: ${this.currentSession}`,`ADMISSION NO: ${this.studentobj?.admissionNo||""}`],[`NAME OF ${this.studentCat}: ${[this.studentobj?.surname||"",this.studentobj?.middleName||"",this.studentobj?.firstName||""].join(" ").trim()}`,`CLASS: ${this.className}`,`NO. ON ROLL: ${this.noInClass}`],[`TEACHER'S NAME: ${this.formTeach}`,`HOUSE: ${this.house}`,`SEX: ${this.studentobj?.sex||""}`],[`NO. OF TIMES SCHOOL OPENED: ${this.estAttendance?.noOfOpenDays||""}`,`NO. OF TIMES PRESENT: ${this.estAttendance?.noPresentDays||""}`,`NEXT TERM BEGINS: ${this.nextResumptionDate}`]],styles:{font:"6px",cellPadding:3,lineColor:"#808080",lineWidth:.2,fontSize:7},headStyles:{lineColor:"white",fontSize:8,fontStyle:"bold"},startY:97,margin:{top:97,left:20,bottom:30},theme:"plain",tableWidth:565}),e.setFontSize(10);let s=this.resultlist,n=[];s.forEach(l=>{let o=[];o.push(l.subject),Object.keys(this.caSetupData).forEach(D=>{o.push(l[D.toLowerCase()])}),o.push(l.totalScore),o.push(l.grade),o.push(l.remark),o.push(l.lowestScore),o.push(l.highestScore),o.push(l.average),n.push(o)});let h=this.caSetupData,d=Object.keys(h),c=Object.values(h),I=Object.values(this.caSetupScoreData);for(let l=0;l<c.length;l++)c[l]=c[l]+"("+I[l]+"%)";c.forEach(l=>{l=l+"("+this.caSetupScoreData.CA1+"%)"});let C=["Subject",...c,"Total Score","Grade","Remark","Lowest Score","Highest Score","Average"],H=n;(0,f.default)(e,{head:[C],useCss:!0,body:n,styles:{font:"8px",lineColor:"#808080",lineWidth:.1,fontSize:8,cellPadding:3},headStyles:{fontSize:6,lineColor:"white",textColor:"white",fillColor:[45,113,177]},startY:175,tableWidth:565,margin:{left:20}});let w=e.previousAutoTable.finalY;(0,f.default)(e,{body:[[{content:`Total Mark Obtainable: ${this.markObtainable}`,colSpan:2,styles:{font:"600"}},{content:`Total Mark Obtained: ${this.studentTotal?.toFixed(1).toString()}`,colSpan:2,styles:{font:"600"}}],[{content:`Pupil Average: ${this.average.toString()}`,styles:{font:"600"}},{content:`Subjects: ${this.subjectOffered}`,colSpan:2,styles:{font:"600"}},{content:`Class Average: ${this.classAverage}`,styles:{font:"600"}}]],theme:"grid",styles:{font:"6px",fontSize:8,cellPadding:3,textColor:"#000000",halign:"center",lineColor:"#808080",lineWidth:.1},startY:w,margin:{left:20},tableWidth:565});let v=e.previousAutoTable.finalY;(0,f.default)(e,{head:[[{content:"SKILL KEY",colSpan:2,styles:{halign:"center",fillColor:"whitesmoke",fontSize:8,textColor:[0,0,0]}}],["SPECIFIC SKILLS","RATING"]],body:this.psycomotorlist.map(l=>[l.skill,l.score]),styles:{font:"9px",fontSize:8,cellPadding:2,lineWidth:.3},startY:v+20,tableWidth:188,margin:{left:20},headStyles:{fillColor:[255,255,255],fontSize:8,textColor:[0,0,0]},theme:"grid",tableLineWidth:.5});let O=e.previousAutoTable.finalY;(0,f.default)(e,{head:[[{content:"RATING KEY",colSpan:2,styles:{halign:"center",fillColor:"whitesmoke",fontSize:7}}],["KEY NAME","KEY VALUE"]],body:[{keyName:"POOR",keyValue:"1"},{keyName:"FAIR",keyValue:"2"},{keyName:"GOOD",keyValue:"3"},{keyName:"VERY GOOD",keyValue:"4"},{keyName:"EXCELLENT",keyValue:"5"},{keyName:"",keyValue:""},{keyName:"",keyValue:""}].map(l=>[l.keyName,l.keyValue]),styles:{font:"8px",fontSize:7,cellPadding:3,lineWidth:.3},startY:v+20,tableWidth:122,margin:{left:213},headStyles:{fillColor:[255,255,255],fontSize:7,textColor:[0,0,0]},theme:"grid",tableLineWidth:.5}),(0,f.default)(e,{head:[[{content:"GRADING KEY",colSpan:4,styles:{halign:"center",fillColor:"whitesmoke",fontSize:7}}],["REMARK","GRADE","MARK FROM","MARK UPTO"]],body:this.gradeScalelist.map(l=>[l.remarks.toUpperCase(),l.grade,l.begLimit,l.endLimit]),styles:{font:"8px",fontSize:7,cellPadding:3,lineWidth:.2},headStyles:{fillColor:[255,255,255],fontSize:7,textColor:[0,0,0]},startY:v+20,margin:{left:339},tableWidth:245,theme:"grid",tableLineWidth:.1}),e.setFont("","","700"),e.setFontSize(9);let k=e.previousAutoTable.finalY,p=O>k?O:k,G=[["CLASS TEACHER'S REMARK:",this.resultComment.formTeacherComment],["SECTION'S HEAD REMARK:",this.resultComment.principalComment]];(0,f.default)(e,{body:G,styles:{fontSize:7,cellPadding:5,lineColor:"#808080",lineWidth:.1},theme:"grid",tableWidth:565,margin:{left:20},startY:p+10}),e.setTextColor("rgb(36, 91, 143)"),e.setFontSize(9),e.setFont("","","600");let P=e.splitTextToSize("Principal's Signature Date & Stamp:",80);e.text(P,415,730),this.genk.isView?this.genk.pdfSource=e.output("datauristring"):e.save("My_Results")}addLogo(){return new Promise((e,t)=>{this.sch.getSchoolLogoArray(this.myschool.id).subscribe(i=>{i?.photo?this.genk.logoString=`data:image/jpeg;base64,${i.photo}`:this.genk.logoString="",e()},i=>t(i))})}addSignature(){return new Promise((e,t)=>{this.sch.obtainSignatureArray(this.currentSessionId,this.currentTerm).subscribe(i=>{debugger;i?.photo?this.genk.signatureString=`data:image/jpeg;base64,${i.photo}`:this.genk.signatureString="",e()},i=>t(i))})}floorNum(e){return Math.floor(e)}over60Num(e){let t=0,s=(e/100*60).toString().split(".");return s.length>1?t=+(s[0]+"."+s[1][0]):t=Number(s[0]),t}over40Num(e){let t=0,s=(e/100*40).toString().split(".");return s.length>1?t=+(s[0]+"."+s[1][0]):t=Number(s[0]),t}getScoreColor(e,t){if(t==100){if(e>=this.grademinimumlist[0].minscore)return this.grademinimumlist[0].color;if(e>=this.grademinimumlist[1].minscore&&e<this.grademinimumlist[0].minscore)return this.grademinimumlist[1].color;if(e>=this.grademinimumlist[2].minscore&&e<this.grademinimumlist[1].minscore)return this.grademinimumlist[2].color;if(e>=this.grademinimumlist[3].minscore&&e<this.grademinimumlist[2].minscore)return this.grademinimumlist[3].color}else if(t==60){if(e>=this.grademinimumlistOver60[0].minscore)return this.grademinimumlistOver60[0].color;if(e>=this.grademinimumlistOver60[1].minscore&&e<this.grademinimumlistOver60[0].minscore)return this.grademinimumlistOver60[1].color;if(e>=this.grademinimumlistOver60[2].minscore&&e<this.grademinimumlistOver60[1].minscore)return this.grademinimumlistOver60[2].color;if(e>=this.grademinimumlistOver60[3].minscore&&e<this.grademinimumlistOver60[2].minscore)return this.grademinimumlistOver60[3].color}}getRemarkColor(e){return this.grademinimumlist.filter(t=>t.remark?.toLowerCase()==e?.toLowerCase())[0]?.color}};a.\u0275fac=function(t){return new(t||a)(m(E),m(F),m(R),m(L),m(B),m(z))},a.\u0275prov=x({token:a,factory:a.\u0275fac,providedIn:"root"});let b=a;return b})();Y();var y=N(W()),S=N(M());var at=(()=>{let a=class a{constructor(e,t,i,s,n,h){this.router=e,this.auth=t,this.activeRoute=i,this.sch=s,this.gen=n,this.resultService=h,this.userName="",this.userImgPath="",this.mobileModal=!1,this.resultlist=[],this.gradeScalelist=[],this.psycomotorlist=[],this.psycomotorlist2=[],this.grademinimumlist=[],this.grademinimumlistOver60=[],this.grademinimumlistOver40=[],this.mySchoolClasses=[],this.gradescaletextlist=[],this.logoLoaded=!1,this.subjectOffered=0,this.markObtainable=0,this.displayValue="hidden",this.chartAverageScore=[],this.chartLowestScore=[],this.chartHighestScore=[],this.chartTotalScore=[],this.chartSubjects=[],this.genk=n,this.userName=t.currentUserValue.name,this.userImgPath=t.currentUserValue.logo,this.adminStatus=t.currentUserValue.status}createResult(e,t,i,s,n,h,d,c){this.genk.topdata="Dashboard",this.studentId=e,this.currentTerm=t,this.currentSessionId=i,this.currentSession=s,this.currentClassId=n,this.average=h,this.position=c,this.classAverage=d,this.getStudent(),this.getStudentTotal(),this.getClassNames(),this.getResultsByStudent(),this.getCaSetupByClass(),this.getGradeScaleByClass(),this.getPsycomotorByStudent(),this.getStudentResultComment(),this.getStudentBMI(),this.getStudentEstimatedAttendance(),this.getStudentHouse(),this.getNextTerm()}setImg(e){return e&&e.length>0?this.genk.imgurl+e:this.genk.defaultImg}getSchool(){this.sch.getSchoolData().subscribe(e=>{this.myschool=e,S.default.fire({title:"Downloading Result...",allowEscapeKey:!1,allowOutsideClick:!1,didOpen:()=>T(this,null,function*(){S.default.showLoading();debugger;yield this.addLogo(),yield this.addSignature();let t=setInterval(()=>{clearInterval(t),clearTimeout(i),this.convertToPDF(),S.default.close()},500),i=setTimeout(()=>{clearInterval(t),S.default.close(),S.default.fire({icon:"error",title:"Failed to download result!",showConfirmButton:!1,timer:2e3})},24e4)})})})}getClassNames(){this.sch.getClassNames().subscribe(e=>{this.mySchoolClasses=e,this.getNoInClass()})}getStudent(){this.sch.getStudentById(this.studentId.toString()).subscribe(e=>T(this,null,function*(){this.studentobj=e}))}getStudentTotal(){this.sch.getStudentTermTotal(this.currentSessionId.toString(),this.currentTerm,this.studentId).subscribe(e=>{this.studentTotal=e.total})}getNoInClass(){this.sch.getNoInClassBySession(this.currentClassId.toString(),this.currentSessionId,this.currentTerm).subscribe(e=>{this.noInClass=e.count,this.className=this.mySchoolClasses.filter(t=>t.id==Number(this.currentClassId))[0].class})}getNextTerm(){this.sch.getNextTerm(this.currentSessionId.toString(),this.currentTerm).subscribe(e=>{e&&(this.nextResumptionDate=e.date)})}getResultsByStudent(){S.default.fire({title:"Loading Result....",allowEscapeKey:!1,allowOutsideClick:!1,didOpen:()=>{S.default.showLoading(),this.sch.getResultsByStudent(this.currentClassId,this.currentSessionId.toString(),this.currentTerm,this.studentId).subscribe(e=>{this.resultlist=e,this.subjectOffered=this.resultlist.length,this.markObtainable=this.resultlist.length*100;let i=this.resultlist.map(s=>s.average).reduce((s,n)=>s+n,0);S.default.close(),this.getSchool()})}})}getStudentResultComment(){this.sch.getStudentResultComment(this.currentClassId,this.currentSessionId.toString(),this.currentTerm,this.studentId).subscribe(e=>{this.resultComment=e})}getCaSetupByClass(){this.sch.getCaSetupByClass(this.currentClassId,this.currentSessionId,this.currentTerm).subscribe(e=>{this.caSetupData=e.systemname,this.caSetupScoreData=e.score})}getStudentBMI(){this.sch.getStudentBMI(this.currentSessionId.toString(),this.currentTerm,this.studentId).subscribe(e=>{this.bmi=e,console.log(this.bmi)})}getStudentEstimatedAttendance(){this.sch.getStudentEstimatedAttendance(this.currentSessionId.toString(),this.currentTerm,this.studentId).subscribe(e=>{this.estAttendance=e,console.log(this.bmi)})}getStudentHouse(){this.sch.getUnitStudentHouse(this.studentId,this.currentSessionId.toString(),this.currentTerm).subscribe(e=>{debugger;this.house=e.house,console.log(this.house)})}getGradeScaleByClass(){this.sch.getGradeScaleByClass(this.currentClassId).subscribe(e=>{this.gradeScalelist=e,this.gradeScalelist.forEach(t=>{t.color=this.gradeColor(t.grade)}),this.grademinimumlist.push({color:"Black",remark:this.gradeScalelist.filter(t=>t.color=="Black")[this.gradeScalelist.filter(t=>t.color=="Black").length-1].remarks,minscore:this.gradeScalelist.filter(t=>t.color=="Black")[this.gradeScalelist.filter(t=>t.color=="Black").length-1].begLimit}),this.grademinimumlist.push({color:"Green",remark:this.gradeScalelist.filter(t=>t.color=="Green")[this.gradeScalelist.filter(t=>t.color=="Green").length-1].remarks,minscore:this.gradeScalelist.filter(t=>t.color=="Green")[this.gradeScalelist.filter(t=>t.color=="Green").length-1].begLimit}),this.grademinimumlist.push({color:"Blue",remark:this.gradeScalelist.filter(t=>t.color=="Blue")[this.gradeScalelist.filter(t=>t.color=="Blue").length-1].remarks,minscore:this.gradeScalelist.filter(t=>t.color=="Blue")[this.gradeScalelist.filter(t=>t.color=="Blue").length-1].begLimit}),this.grademinimumlist.push({color:"Red",remark:this.gradeScalelist.filter(t=>t.color=="Red")[this.gradeScalelist.filter(t=>t.color=="Red").length-1].remarks,minscore:this.gradeScalelist.filter(t=>t.color=="Red")[this.gradeScalelist.filter(t=>t.color=="Red").length-1].begLimit}),this.grademinimumlistOver60.push({color:"Green",minscore:this.over60Num(this.gradeScalelist.filter(t=>t.color=="Green")[this.gradeScalelist.filter(t=>t.color=="Green").length-1].begLimit)}),this.grademinimumlistOver60.push({color:"Black",minscore:this.over60Num(this.gradeScalelist.filter(t=>t.color=="Black")[this.gradeScalelist.filter(t=>t.color=="Black").length-1].begLimit)}),this.grademinimumlistOver60.push({color:"Blue",minscore:this.over60Num(this.gradeScalelist.filter(t=>t.color=="Blue")[this.gradeScalelist.filter(t=>t.color=="Blue").length-1].begLimit)}),this.grademinimumlistOver60.push({color:"Red",minscore:this.over60Num(this.gradeScalelist.filter(t=>t.color=="Red")[this.gradeScalelist.filter(t=>t.color=="Red").length-1].begLimit)}),console.log(this.grademinimumlist)})}gradeColor(e){return e.includes("A")||e.includes("B2")?"Black":e.includes("B3")||e.includes("C4")?"Green":e.includes("C5")||e.includes("C6")?"Blue":e.includes("D")||e.includes("E")||e.includes("F")?"Red":"Black"}getPsycomotorByStudent(){this.sch.getPsycomotorByStudent(this.currentSessionId.toString(),this.currentTerm,this.studentId).subscribe(e=>{e.length>0?(this.psycomotorlist=e.slice(0,Math.round(e.length/2)),this.psycomotorlist2=e.slice(Math.round(e.length/2),e.length)):this.sch.getSkillList().subscribe(t=>{this.psycomotorlist=t.slice(0,Math.round(t.length/2)),this.psycomotorlist2=t.slice(Math.round(t.length/2),t.length)})})}convertToPDF(){0 .toPrecision(1);var t=new A("p","pt","letter"),i=t.internal.pageSize.height||t.internal.pageSize.getHeight(),s=t.internal.pageSize.width||t.internal.pageSize.getWidth();t.setFont("Trebuchet MS","normal","900"),t.setTextColor("rgb(36, 91, 143)"),t.setFontSize(20),t.text(this.myschool?.schoolName??"",s/2,30,{align:"center"}),this.genk.logoString&&t.addImage(this.genk.logoString,"PNG",270,40,55,55),this.genk.signatureString&&t.addImage(this.genk.signatureString,"PNG",495,705,70,55),t.setFontSize(10),t.setTextColor("rgb(0, 0, 0)"),t.setFont("","","700"),t.text("Postal Address:",20,60),t.setFont("","","500");let n=t.splitTextToSize(this.myschool?.address??"",220);if(t.text(n,20,73),t.setFont("","","700"),t.text("Email:",380,60),t.setFont("","","500"),t.text(this.myschool?.email??"",418,60),t.setFont("","","700"),t.text("Phone:",380,74),t.setFont("","","500"),t.text(this.myschool?.phoneOne??"",418,74),t.setFont("","","700"),t.text("website:",380,88),t.setFont("","","500"),t.text(this.myschool?.website??"",424,88),t.setDrawColor(36,91,143),t.setLineWidth(2),t.line(20,100,580,100),t.setFontSize(8),t.setFont("","","700"),t.text("STUDENTS NAME:",20,120),t.setFont("","","500"),t.text(((this.studentobj?.surname??"")+" "+(this.studentobj?.middleName??"")+" "+(this.studentobj?.firstName??"")).trim(),113,120),t.setFont("","","700"),t.text("CLASS:",20,132),t.setFont("","","500"),t.text(this.className??"",113,132),t.setFont("","","700"),t.text("NO. IN CLASS:",20,144),t.setFont("","","500"),t.text(this.noInClass.toString(),113,144),t.setFont("","","700"),t.text("AVERAGE SCORE:",20,156),t.setFont("","","500"),t.text(this.average.toString(),113,156),t.setFont("","","700"),t.text("TOTAL SCORE:",20,168),t.setFont("","","500"),t.text(this.studentTotal.toFixed(1).toString(),113,168),t.setFont("","","700"),t.text("POSITION IN CLASS:",20,180),t.setFont("","","500"),t.text(this.position.toString(),113,180),t.setFont("","","700"),t.text("TERM:",380,120),t.setFont("","","500"),t.text(this.currentTerm,460,120),t.setFont("","","700"),t.text("SESSION:",380,132),t.setFont("","","500"),t.text(this.currentSession,460,132),t.setFont("","","700"),t.text("ADMISSION NO.:",380,144),t.setFont("","","500"),t.text(this.studentobj?.admissionNo??"",460,144),t.setFont("","","700"),t.setFontSize(7),t.text("NEXT TERM BEGINS:",380,156),t.setFont("","","500"),this.nextResumptionDate){let r=new Date(this.nextResumptionDate),u=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"numeric"}).format(r);t.setFontSize(8),t.text(u,460,156)}t.setFont("","","700"),t.text("HOUSE:",380,168),t.setFont("","","500"),t.text("",460,168),t.setFont("","","700"),t.text("NO OF TIMES PRESENT:",380,180),t.setFont("","","500"),t.text("",460,180),t.setFontSize(12),t.setFont("","","700"),t.text("CONTINUOUS ASSESSMENT DOSSIER FOR JUNIOR SECONDARY SCHOOL",s/2,200,{align:"center"});let h=this.resultlist,d=[];h.forEach(r=>{let u=[];u.push(r.subject),Object.keys(this.caSetupData).forEach(q=>{u.push(r[q.toLowerCase()])}),u.push(r.totalScore?.toFixed(2)),u.push(r.grade),u.push(r.remark),u.push(r.position),u.push(r.lowestScore?.toFixed(2)),u.push(r.highestScore?.toFixed(2)),u.push(r.average),d.push(u)});let c=this.caSetupData,I=Object.keys(c),C=Object.values(c),H=Object.values(this.caSetupScoreData);for(let r=0;r<C.length;r++)C[r]=C[r];let w=["Subject",...C,"Total Score","Grade","Remark","Position","Lowest Score","Highest Score","Average"],v=d;(0,y.default)(t,{head:[w],body:d,alternateRowStyles:{fillColor:[245,245,245]},styles:{font:"8px",lineColor:[200,200,200],lineWidth:.1,fontSize:8,cellPadding:3},headStyles:{fontSize:7,lineColor:"white",halign:"left",valign:"middle",textColor:"white",fillColor:[45,113,177],cellPadding:[5,1,5,3]},startY:205,tableWidth:562,margin:{left:20}});let O=t.previousAutoTable.finalY,j=[[{content:"HEIGHT",colSpan:2,styles:{halign:"center",fontStyle:"bold",fontSize:7}},{content:"WEIGHT",colSpan:2,styles:{halign:"center",fontStyle:"bold",fontSize:7}},{content:"SOCIETIES/CLUBS",colSpan:4,styles:{halign:"center",fontStyle:"bold",fontSize:7}}],[{content:"Beginning of Term",styles:{fontStyle:"bold",fontSize:6}},{content:"End of Term",styles:{fontStyle:"bold",fontSize:6}},{content:"Beginning of Term",styles:{fontStyle:"bold",fontSize:6}},{content:"End of Term",styles:{fontStyle:"bold",fontSize:6}},{content:"Academic",styles:{fontStyle:"bold",fontSize:6}},{content:"Social",styles:{fontStyle:"bold",fontSize:6}},{content:"Pious",styles:{fontStyle:"bold",fontSize:6}},{content:"Social Acad",styles:{fontStyle:"bold",fontSize:6}}]],k=[[{content:`${this.bmi?.heightBOT||""}cm`,styles:{fontSize:7}},{content:`${this.bmi?.heightEOT||""}cm`,styles:{fontSize:7}},{content:`${this.bmi?.weightBOT||""}cm`,styles:{fontSize:7}},{content:`${this.bmi?.weightEOT||""}cm`,styles:{fontSize:7}},{content:"0",styles:{fontSize:7}},{content:"",styles:{fontSize:7}}]];t.setFontSize(9),(0,y.default)(t,{head:j,body:k,startY:O+10,styles:{fontSize:6,cellPadding:2,lineColor:"#808080",lineWidth:.1},tableWidth:565,margin:{top:150,left:20,bottom:30},headStyles:{fillColor:[255,255,255],textColor:[0,0,0],fontSize:7},alternateRowStyles:{fillColor:[255,255,255]}});let p=t.previousAutoTable.finalY;t.setFontSize(9),t.setFont("","","600"),t.text("PSYCOMOTOR DOMAIN",85,p+16),t.setFont("","","600"),t.text("COGNITIVE DOMAIN RATING",382,p+16),(0,y.default)(t,{head:[["Color","Grade","Over 100","Over 60","Over 40"]],body:this.gradeScalelist.map(r=>[{content:r.color,styles:{fontStyle:"bold",textColor:r.color.toLowerCase()}},r.grade,r.begLimit+" - "+this.floorNum(r.endLimit),this.over60Num(r.begLimit)+" - "+this.over60Num(r.endLimit),this.over40Num(r.begLimit)+" - "+this.over40Num(r.endLimit)]),styles:{fontSize:6,cellPadding:3,lineColor:"#808080",lineWidth:.1},headStyles:{fontStyle:"bold",fontSize:6,fillColor:[230,230,230],textColor:[0,0,0]},alternateRowStyles:{fillColor:[255,255,255]},tableWidth:280,startY:p+20,margin:{top:150,left:300,bottom:30}});let G=t.previousAutoTable.finalY;(0,y.default)(t,{body:this.psycomotorlist.map(r=>[r.skill,r.score]),styles:{fontSize:7,cellPadding:3,lineColor:"#808080",lineWidth:.1},headStyles:{fontStyle:"bold",fillColor:[250,250,250],textColor:[0,0,0],fontSize:7},alternateRowStyles:{fillColor:[255,255,255]},columnStyles:{0:{halign:"left"},1:{halign:"center"}},startY:p+20,margin:{top:150,left:20,bottom:30},tableWidth:130}),(0,y.default)(t,{body:this.psycomotorlist2.map(r=>[r.skill,r.score]),styles:{fontSize:7,cellPadding:3,lineColor:"#808080",lineWidth:.1},headStyles:{fontStyle:"bold",fillColor:[250,250,250],textColor:[0,0,0],fontSize:7},alternateRowStyles:{fillColor:[255,255,255]},columnStyles:{0:{halign:"left"},1:{halign:"center"}},startY:p+20,margin:{top:150,left:150,bottom:30},tableWidth:130});let P=t.previousAutoTable.finalY;(0,y.default)(t,{body:[[{content:"1 = Unsatisfactory 2 = Below Average 3 = Average 4 = Good 5 = Excellent",styles:{halign:"left",cellPadding:5}}]],styles:{fontSize:7,cellPadding:2,lineColor:"#808080",lineWidth:.1},startY:P+5,tableWidth:280,margin:{top:150,left:20,bottom:30},theme:"plain"});let o=t.previousAutoTable.finalY;t.setTextColor("rgb(36, 91, 143)"),t.setFontSize(9),t.setFont("","","600");let D=t.splitTextToSize("House Mother Comment:",150);t.text(D,20,o+40),t.setFont("","","200"),t.setTextColor("rgb(0, 0, 10)");let $=t.splitTextToSize(this.resultComment?.formTeacherComment??"",370);t.text($,176,o+40),t.setDrawColor(0,0,0),t.setLineWidth(1),t.line(170,o+43,580,o+43),t.setFontSize(9),t.setFont("","","600"),t.setTextColor("rgb(36, 91, 143)");let U=t.splitTextToSize("Form Teacher's Comment:",100);t.text(U,20,o+60),t.setFont("","","200"),t.setTextColor("rgb(0, 0, 0)");let V=t.splitTextToSize(this.resultComment?.formTeacherComment??"",370);t.text(V,176,o+60),t.setDrawColor(0,0,0),t.setLineWidth(1),t.line(170,o+63,580,o+63),t.setFontSize(9),t.setFont("","","600"),t.setTextColor("rgb(36, 91, 143)");let K=t.splitTextToSize("Principal's Comment:",100);t.text(K,20,o+80),t.setFont("","","200"),t.setTextColor("rgb(0, 0, 0)");let X=t.splitTextToSize(this.resultComment?.principalComment??"",370);t.text(X,176,o+80),t.setDrawColor(0,0,0),t.setLineWidth(1),t.line(170,o+83,580,o+83),t.setTextColor("rgb(36, 91, 143)"),t.setFontSize(9),t.setFont("","","600");let J=t.splitTextToSize("Principal's Signature Date & Stamp:",80);t.text(J,415,o+120),this.genk.isView?this.genk.pdfSource=t.output("datauristring"):t.save("My_Results")}addLogo(){return new Promise((e,t)=>{this.sch.getSchoolLogoArray(this.myschool.id).subscribe(i=>{i?.photo?this.genk.logoString=`data:image/jpeg;base64,${i.photo}`:this.genk.logoString="",e()},i=>t(i))})}addSignature(){return new Promise((e,t)=>{this.sch.obtainSignatureArray(this.currentSessionId,this.currentTerm).subscribe(i=>{debugger;i?.photo?this.genk.signatureString=`data:image/jpeg;base64,${i.photo}`:this.genk.signatureString="",e()},i=>t(i))})}floorNum(e){return Math.floor(e)}over60Num(e){let t=0,s=(e/100*60).toString().split(".");return s.length>1?t=+(s[0]+"."+s[1][0]):t=Number(s[0]),t}over40Num(e){let t=0,s=(e/100*40).toString().split(".");return s.length>1?t=+(s[0]+"."+s[1][0]):t=Number(s[0]),t}getScoreColor(e,t){if(t==100){if(e>=this.grademinimumlist[0].minscore)return this.grademinimumlist[0].color;if(e>=this.grademinimumlist[1].minscore&&e<this.grademinimumlist[0].minscore)return this.grademinimumlist[1].color;if(e>=this.grademinimumlist[2].minscore&&e<this.grademinimumlist[1].minscore)return this.grademinimumlist[2].color;if(e>=this.grademinimumlist[3].minscore&&e<this.grademinimumlist[2].minscore)return this.grademinimumlist[3].color}else if(t==60){if(e>=this.grademinimumlistOver60[0].minscore)return this.grademinimumlistOver60[0].color;if(e>=this.grademinimumlistOver60[1].minscore&&e<this.grademinimumlistOver60[0].minscore)return this.grademinimumlistOver60[1].color;if(e>=this.grademinimumlistOver60[2].minscore&&e<this.grademinimumlistOver60[1].minscore)return this.grademinimumlistOver60[2].color;if(e>=this.grademinimumlistOver60[3].minscore&&e<this.grademinimumlistOver60[2].minscore)return this.grademinimumlistOver60[3].color}}getRemarkColor(e){return this.grademinimumlist.filter(t=>t.remark?.toLowerCase()==e?.toLowerCase())[0]?.color}};a.\u0275fac=function(t){return new(t||a)(m(E),m(F),m(R),m(L),m(B),m(z))},a.\u0275prov=x({token:a,factory:a.\u0275fac,providedIn:"root"});let b=a;return b})();export{rt as a,at as b};
